<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1.0, user-scalable=no">

    <title>basic</title>

    <script src='../libs/jquery-2.0.3.min.js'></script>

    <script src='../libs/threejs/three.js'></script>
    <script src='../libs/threejs/CSS3DRenderer.js'></script>


    <script src="../libs/ramb3d/core.js"></script>




    <script>

        $(function() {

            var Smgr = new ramb3d.scene.SceneManager({
                camera : {
                    fov : 45,
                    far : 5000,
                    near : 1,
                    position : new THREE.Vector3(0, 0, 500),
                    lookat : new THREE.Vector3()

                }
            });

            var object = ramb3d.util.createPlane({
                name : 'hello-plane',
                width : 128,
                height : 128,
                texture : '../res/park.jpg',
                render_type : 'css3',
                parent : Smgr.scene

            });

            var object2 = ramb3d.util.createPlane({
                name : 'hello-plane2',
                width : 128,
                height : 128,
                texture : '../res/cafe.jpg',
                render_type : 'css3',
                parent : object

            });

            object2.position.set(0,128,0);

            Smgr.updateAll();

            //이벤트처리
            var canvas_dom = Smgr.renderer.domElement;

            canvas_dom.addEventListener( 'mousedown', onDocumentMouseDown, false );

            window.addEventListener( 'resize', onWindowResize, false );

            function onWindowResize() {

                Smgr.updateAll({
                    resize : {
                        width :  window.innerWidth,
                        height : window.innerHeight
                    }
                });

            }

            function onDocumentMouseDown( event ) {

                //console.log('mdown');

                event.preventDefault();

                canvas_dom.addEventListener( 'mousemove', onDocumentMouseMove, false );
                canvas_dom.addEventListener( 'mouseup', onDocumentMouseUp, false );

            }

            function onDocumentMouseMove( event ) {
                var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
                var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;

                console.log(event);

                object.rotation.y += movementX * 0.01;
                object.rotation.x -= movementY * 0.01;

                //매트릭스 css3 적용
//                object.updateMatrix();

                Smgr.updateAll();


            }

            function onDocumentMouseUp( event ) {

                canvas_dom.removeEventListener( 'mousemove', onDocumentMouseMove );
                canvas_dom.removeEventListener( 'mouseup', onDocumentMouseUp );

            }



        });


    </script>

</head>

<body style="margin: 0px;">


</body>
</html>