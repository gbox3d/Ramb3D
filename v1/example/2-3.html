<!DOCTYPE html>
<html>
<head>
    <title>fps 카메라 형식 오브잭트 회전(애니메이션 루프 적용 버전) </title>

    <style>
        .css3dobj {
            position: absolute;
            -webkit-transform-style: preserve-3d;
            -webkit-backface-visibility : hidden;
        }
    </style>

    <script src='../libs/thressjs/three.js'></script>
    <script src='../libs/thressjs/gbox3d.CSS3DObject.js'></script>
    <script src='../libs/thressjs/gbox3d.ext.three.js'></script>
    <script src='../libs/thressjs/CSS3DRenderer.js'></script>
    <script src='../libs/thressjs/gbox3d.CSS3DPerspCamera.js'></script>

    <script>

        window.onload = function() {

            var renderer = new THREE.CSS3DRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );


            var camera = new THREE.CSS3DPerspectiveCamera(
                    90,window.innerWidth / window.innerHeight, 1, 1000,
                    renderer.cameraElement
            );
            camera.position.set(0,0,500);
            camera.lookAt( new THREE.Vector3(0,0,0) );

            var scene = new THREE.Scene();

            var element = document.querySelector('#cube');
            var object = new THREE.CSS3DObject( element );
            object.position.set(0,0,0);
            scene.add( object );


            //게임루프
            (function gameloop() {
                //재호출을 위한 부분...
                requestAnimationFrame(gameloop);
                renderer.render( scene, camera );

            })();



            //이벤트처리
            document.addEventListener( 'mousedown', onDocumentMouseDown, false );
            document.addEventListener( 'mousewheel', onDocumentMouseWheel, false );

            window.addEventListener( 'resize', onWindowResize, false );

            function onWindowResize() {

                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();

                renderer.setSize( window.innerWidth, window.innerHeight );

                camera.update(window.innerWidth, window.innerHeight);

            }

            function onDocumentMouseDown( event ) {

                event.preventDefault();

                document.addEventListener( 'mousemove', onDocumentMouseMove, false );
                document.addEventListener( 'mouseup', onDocumentMouseUp, false );

            }


            function onDocumentMouseMove( event ) {

                var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
                var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;

                //fps 카메라식으로 회전시키기 위하여...
                object.eulerOrder = 'YXZ'

                object.rotation.x += movementY * 0.01;
                object.rotation.y += movementX * 0.01;


            }

            function onDocumentMouseWheel( event ) {

                console.log(event.wheelDeltaY);
                event.preventDefault();

                //전방으로 이동
                object.translateZ(event.wheelDeltaY);

            }


            function onDocumentMouseUp( event ) {

                document.removeEventListener( 'mousemove', onDocumentMouseMove );
                document.removeEventListener( 'mouseup', onDocumentMouseUp );

            }

        }

    </script>

</head>
<body>

<div id='cube' class="css3dobj">

    <div
            class="css3dobj"
            style="
                background-image: url(../res/t351sml.jpg);
                width: 128px;
                height: 128px;

                -webkit-transform : translate3d(-50%,-50%,0) translate3d(0px,0px,64px);
            ">

    </div>

    <div
            class="css3dobj"
            style="
                background-image: url(../res/t351sml.jpg);
                width: 128px;
                height: 128px;

                -webkit-transform : translate3d(-50%,-50%,0) translate3d(64px,0px,0px) rotateY(90deg);
            ">

    </div>

    <div
            class="css3dobj"
            style="
                background-image: url(../res/t351sml.jpg);
                width: 128px;
                height: 128px;

                -webkit-transform : translate3d(-50%,-50%,0) translate3d(-64px,0px,0px) rotateY(-90deg);
            ">

    </div>

    <div
            class="css3dobj"
            style="
                background-image: url(../res/t351sml.jpg);
                width: 128px;
                height: 128px;

                -webkit-transform : translate3d(-50%,-50%,0) translate3d(0px,0px,-64px) rotateY(180deg);
            ">

    </div>

    <div
            class="css3dobj"
            style="
                background-image: url(../res/t351sml.jpg);
                width: 128px;
                height: 128px;

                -webkit-transform : translate3d(-50%,-50%,0) translate3d(0px,-64px,0px) rotateX(90deg);
            ">

    </div>

    <div
            class="css3dobj"
            style="
                background-image: url(../res/t351sml.jpg);
                width: 128px;
                height: 128px;

                -webkit-transform : translate3d(-50%,-50%,0) translate3d(0px,64px,0px) rotateX(-90deg);
            ">

    </div>


</div>


</body>
</html>